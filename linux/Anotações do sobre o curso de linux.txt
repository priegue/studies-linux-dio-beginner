-----------------------------------
Anotações do sobre o curso de linux
-----------------------------------

-- Acesso remoto a maquinas linux:
windows aplicativo putty, powerShell e windows terminal
linux serviço openSSH

-- Instalando o serviço openSSH
prompt@cursoserver:/$ apt-get install openssh-server

-- Acessando pelo serviço openSSH (maquinas de uma mesma rede)
prompt@cursoserver:/$ ssh usuario@192.168.0.33 (usuario do sistema @ ip do computador)

-- Acessando pelo serviço openSSH (maquinas em serviço de nuvem ex: AWS)
precisa gerar o certificado .pem
-- procedimento para gerar chave PEM
na hora da criação da instancia Ec2, ir na opção "par de chaves" 
criar novo par de chaves
dar um nome para essa chave
tipo de par de chaves (padrão RSA)
formato de chave privada (PEM)
criar par de chaves
--

prompt@cursoserver:/$ ssh -i arquivo.pem usuario@192.168.0.33
-- Caso o acesso retorne com: 
"WARNING: UNPROTECTED PRIVATE KEY FILE" permission denied (publickey)
precisa alterar as permissões do arquivo.pem
prompt@cursoserver:/$ chmod 600 arquivo.pem (autorizando as permissões o acesso é permitido)
-- 

-- Descrição do prompt
prompt@cursoserver:~$ ("usuario do sistema" @ "localhost" : "local onde esta" "usuario com restrições"
prompt@cursoserver:~# ("usuario do sistema" @ "localhost" : "local onde esta" "super usuario"

-- tecla TAB 2x mostra os diretorios dentro de um determinado caminho
exemplo:
prompt@cursoserver:/$ cd /var/lib/"TAB 2x" (mostra todos os diretorios dentro da pasta "lib")
caso tiver apenas 1 diretorio dentro da pasta o "TAB 2x" já preenche com o nome desse diretorio

-- tecla TAB 1x preenche o resto de nomes de arquivos e diretorios dentro de um determinado caminho
exemplo:
prompt@cursoserver:/$ cd /var/lib/up"TAB 1x" (mostra todos os diretorios e arquivos iniciando com up dentro da pasta "lib")
 		          ╰─ update-manager/   update-notifier/  upower/

-- | more (exibe o conteúdo que caiba na tela)
apertando <enter> passa linha a linha
CRTL + C cancela o comando

-- cd ~ (vai direto para o diretório do usuário)

-- ls (listar arquivos e diretórios)
- (-l) lista longa
 |───────|->Permissões            |────────────|->data que foi criado ou modificado
lrwxrwxrwx   1 root root          8 abr  9 09:06 sbin -> usr/sbin
╰─link         ╰─usuario dono do arquivo ou diretorio      

drwxr-xr-x   2 root root       4096 abr 15 14:14 srv
╰─diretório   ╰─2 objetos dentro do diretorio
                    |──|->grupo    
-rw-------   1 root root 4014997504 jul 14 18:36 swap.img
╰─arquivo    ╰─identifica 1 arquivo         		 |──────|-> nome do diretório ou arquivo

- (-a) exibe arquivos ocultos
- (-h) exibe tamanho dos arquvios e diretorios em formato humano

-- ls p* (comando "ls" + "caracter" + "*") 
- lista todos os diretórios e arquivos que comecem com a o caracter escolhido.

-- ls m?g* (comando "ls" "caracter" + "?" + "caracter" + "*")
- lista todos os diretórios e arquivos que iniciem com "m" "qualquer caracter" "g" "*"

-- ls teste[1-3]*  (no exemplo o diretório tem os arquivos "teste1.txt / teste2.txt / teste3.txt / teste4.txt / teste5.txt)
- lista todos os arquivos que iniciem com teste de 1 a 3
-- ls teste[2,5]*
- lista todos os arquivos que iniciem com teste 2 e 5
-- ls teste[^2,5] (^ simbolo de negação)
- lista todos os arquivos que iniciem com teste menos o 2 e o 5
-- ls teste[^3-5]
- lista todos os arquivos que iniciem com teste menos de 3 a 5

-- find -name "nome" (busca um arquivo pelo nome)
Exemplo:
prompt@cursoserver: find -name texto
- (-type f) restringe a busca apenas a arquivos (exclui diretórios, links, etc)
Exemplo:
prompt@cursoserver: find /home -type f -name "*.txt" (busca todos os arquivos .txt do diretório home)

-- mkdir 'qualquer nome' (criar diretórios com espaço entre as palavras, tem que ser entre aspas simples'
Exemplo:
prompt@cursoserver: mkdir teste
prompt@cursoserver: mkdir 'meu teste'

-- rm (excluir arquivos)
- (-r) recusivo
- (-f) força a exclusão
- (-v) exibe o que esta sendo feito no momento
- (-i) pergunta se deseja excluir o arquivo
Exemplo:
prompt@cursoserver: rm -rfvi diretório ou arquivo


-- help / man
- man (vem antes do comando)
- (--help) vem depois do comando
Exemplo:
prompt@cursoserver: man cd
prompt@cursoserver: ls --help


-- mudar senha do root
- sudo passwd root
Exemplo:
prompt@cursoserver: sudo passwd root

-- acesso remoto como root
- editar o arquivo /etc/ssh/sshd_config
mudar a linha #PermitRootLogin prohibit-password
para PermitRootLogin yes
- reboot o sistema ou restart o serviço sshd

-- history (historico de comandos de um usuário)
- (30) lista os ultimos 30 comandos / (3) lista os ultimos 3 comandos
- (!10) executa o comando executado de numero 10 da lista do history
- (!!) executa o ultimo comando utilizado
- (!?dat?) busca um determinado termo no history (no exemplo ele vai achar o comando date e executa automaticamente)
-- (history | grep "texto") - (consulta um termo ou comando conforme o "texto" digitado) - "grep - como para buscar padrões"
- Para exibição da data e hora no history, tem que mudar a variavel de ambiente do SO.
Exemplo:
prompt@cursoserver:/$ export HISTTIMEFORMAT="%c "
- (-c) apaga todo o historico

-- Para parar de gravar o historico tem mudar o parametro do bash/terminal
Exemplo:
prompt@cursoserver:/$ set +o history (para reverter (-o))

-- Para mudar a quantidade de comandos armazenados tem que alterar o arquivo oculto .bashrc na pasta do usuário.
- mudar a linha HISTSIZE=1000 (mudar para a quantidade desejada)

-- (-w) Para armazenar o historico em um arquivo (arquivo é salvo na pasta do usuário .bash_history)
- Para mudar o tamanho maximo do arquivo .bash_history,
  tem que alterar no arquivo .bashrc na linha HISTFILESIZE=2000 (mudar para a quantidade desejada)

-- useradd (cria usuários no sistema)
- (-m) cria o diretório home do usuário
- (-c "texto") coloca um comentário - (geralmente é o nome do usuário)
- (-s /bin/bash)) indica qual o bash desse novo usuário
- (-e 00/00/0000) cria um usuário com data de expiração
- (-p $(openssl passwd -crypt senha)) cria senha criptografada [ubuntu 24.04]
- (printf 'usuario:senha' | chpasswd) cria senha criptografada [ubuntu 25.04]
- (-G) cria o usuário já direcionando para varios grupos (-g) cria o usuário já direcionando para um grupo

Exemplo:
prompt@cursoserver:/$ useradd rebeca -m -c "minha filha" -s /bin/bash -e 22/07/2025 -p $(openssl passwd -crypt senha)
prompt@cursoserver:/$ useradd rebeca -m -c "minha filha" -s /bin/bash -e 22/07/2025 -G grupoteste && printf 'rebeca:senha' | chpasswd

-- userdel (deleta usuários do sistema)
- (-r) remove o diretório home do usuário
- (-f) força a remoção do usuário
Exemplo:
prompt@cursoserver:/$ userdel -rf rebeca

-- passwd (cria senha para um determinado usuário do sistema)
- Arquivo de informações dos usuários do sistema (/etc/passwd)
Exemplo:
prompt@cursoserver:/$ passwd rebeca
- (-e 00/00/0000) data de expiração da senha ou (-e) no primeiro acesso o usuário precisará troca de senha)
Exemplo:
prompt@cursoserver:/$ passwd rebeca -e 23/07/2025
prompt@cursoserver:/$ passwd rebeca -e

-- usermod (faz alterações no usuário)
Exemplo:
prompt@cursoserver: usermod rebeca -s /bin/bash
- (-G) adiciona o usuário para varios grupos (-g) adicioona o usuário para um grupo
Exemplo:
prompt@cursoserver: usermod -G adm,sudo usuario1

-- groupadd (cria grupos no sistema)
- Arquivo de informações dos grupos do sistema (/etc/group)
Exemplo:
prompt@cursoserver: groupadd testegrupo

-- groupdel (apaga grupos do sistema)
Exemplo:
prompt@cursoserver: groupdel testegrupo

-- gpasswd (opções/ajustes de grupos)
- (-d) remove usuário do grupo
- (-a) adiciona usuário ao grupo
Exemplo:
prompt@cursoserver: gpasswd -d usuario testegrupo

-- chown (altera o dono/grupo de diretorios e arquivos)
Exemplo:
prompt@cursoserver: chown usuario:grupo diretorio
prompt@cursoserver: chown diego:jogos /home/priegue/jogos

-- chmod (altera permissões de diretórios e arquivos)
- Leitura (R) - 4
- Gravação (w) - 2
- execução (x) - 1
- nenhuma (-) - 0

Exemplo:
prompt@cursoserver: chmod dono grupo outros diretorio
prompt@cursoserver: chmod   7    5     0     /home/priegue/jogos
prompt@cursoserver: chmod 750 /home/priegue/jogos

- (+x) já tribui execução ao dono - (-x) remove a execução
Exemplo:
prompt@cursoserver: chmod +x teste.sh

GERENCIAMENTO DE PACOTES (UBUNTU/DEBIAN)
-- apt (instalação/desinstalação/gerenciamentos de pacotes)
-- apt-get (usado mais em scripts)

apt list --installed (verifica softwares instalados na maquina)
apt list --upgradeable (verifica se existe atualizações para os softwares instalados na maquina)
apt search samba (faz uma busca por um determinado software, no exemlo é o samba)
apt install net-tools (instala o software especifico, no exemplo é o net-tools)
apt remove net-tools (remove o software especifico, no exemplo é o net-tools)
apt edit-sources (edita a lista de repositórios)
apt update (lista as atualizações dos pacotes disponiveis)
apt upgrade (atualiza os pacotes disponiveis para atualização)

GERENCIAMENTO DE PACOTES (REDHAT-CENTOS)
-- dnf
-- yum

* mesmo comandos do ubuntu
dnf install net-tools
dnf list --installed

INSTALAÇÃO DE ARQUIVOS .DEB 

apt install ./nomedoarquivo.deb

INSTALAÇÃO DE ARQUIVOS .RPM

dnf install ./nomedoarquivo.rpm

GERENCIAMENTO DE DISCOS

lsblk (lista todos os discos do pc e os diretórios onde estão  montados)
fdisk -l (lista todos os discos do pc)

--criação de partição

fdisk /dev/sdb
(dispositivos sempre ficam na pasta "dev")
(discos sempre são indicados por letra, ex. sda sdb sdc sdd...)
(as patições sempre são indicados por numeros, ex. sda1 sda2 sdb1 sdb2...)
--comandos do fdisk
m (ajuda)
n (cria nova partição)
p (partição primária)
w (salva)

--formatando partição
mkfs.ext4 /dev/sdb
(caso queira o sistema de arquivos em ext3, basta alterar para mkfs.ext3)

--montando disco
(os discos montados por padrão ficam no dioretório /mnt)
(criar uma pasta dentro do /mnt com o nome do disco que desejar)
mount /dev/sdb /mnt/nomedodiretoriocriado
--desmontar o disco
umount /dev/sdb

--MONTAGEM DO DISCO AUTOMATICAMENTE AO LIGAR O PC
--o arquivo fstab onde se edita se encontra em /etc
nano /etc/fstab
--adicionar a linha no arquivo
/dev/sdb /mnt/nomedodiretorio defaults 0 0

--MANIPULANDO ARQUIVOS
--copiando arquivos
-- cp
cp "parametro" "origem" nomedoarquivo "destino"
exemplo
cp -i /home/priegue/imagem.jpg /mnt/disk2

-paramêtros
-i (pergunta se quer sobreescrever quando o mesmo arquivo está no diretorio)
-R (copia arquivos e pastas)
-v (descreve na tela o que esta sendo feito)

--movendo arquivos
-- mv
mv "parametro" "origem" nomedoarquivo "destino"
exemplo
mv -i /home/priegue/imagem.jpg /mnt/disk2

-paramêtros
-i (pergunta se quer sobreescrever quando o mesmo arquivo está no diretorio)
-v (descreve na tela o que esta sendo feito)-usado para renomear arquivos

--PROCESSOS
-- ps
-paramêtros
a (mostra o processo de todos os usuários)
u (fornece o nome do usuário que iniciou o processo)
x (mostra os processos executados fora do console)
ex.
ps aux

-- kill
kill "numerodaid"
killall "nomedoprocesso" (fecha todos os processos que tenham o nome escolhido)
kill "pindousuario" (desconecta o usuário daquele determinado pin)
ex.
kill 1234
killall chrome
kill 4321

-- w (mostra quais os usuários que estão logados no momento dentro do sistema)
-- who -a (mostra o pin do usuários logados no sistema)

--CRIANDO SERVIDOR DE ARQUIVOS SAMBA
- o protocolo de compartilhamento de arquivos no windows é smb. "samba" software linux para esse compartilhamento.
- instalar o software samba
apt install samba -y
- definir a pasta a ser compartilhada no samba
nano /etc/samba/smb.conf

[publica] --- nome da pasta compartilhada
path = /mnt/disktest/publica --- caminho onde esta a pasta a ser compartilhada
writable = yes --- libera gravação na pasta compartilhada por qualquer usuário
guest ok = yes --- qualquer usuário tem acesso a pasta
guest only = yes --- qualquer usuário que acessar a pasta será um convidado

-- quando se altera um arquivo de configuração, tem que restartar o serviço
-- o samba é um serviço e é executado em segundo plano (ouvindo requisições)
esse tipo de serviço em segundo plano é chamdo de "daemon"
-- para iniciar,reiniciar e fechar serviços em segundo plano usa-se o comando "systemctl"
systemctl restart smbd -- (quando um serviço é de segundo plano no final do nome do serviço acrescenta a letra "d" de daemon)
-- para verificar o status de serviços em segundo plano
systemctl status smbd
-- para que o serviço suba automaticamente quando o pc for ligado usa-se
systemctl enable smdb 
-- quando o dono do arquivo for "nobody" e dono do grupo for "nogroup" significa que qualquer usuario da rede pode ter acesso 777 a esse arquivo.

--CRIANDO SERVIDOR WEB
- a aplicação a ser instalada para o servidor web é "apache2"
apt install apache2
- caso queira consultar se o serviço apache esta rodando, usar o systemctl
- por padrão o index.html esta em /var/www/html/
- para visualisar a pagina basta colocar no navegador o endereço ip do seu servidor

--CRIANDO SERVIDOR DE BANCO DE DADOS
- a aplicação a ser instalada para o banco de dados é "mysql-server-8.0"
apt install mysql-server-8.0
- para acessar o banco de dados mysql como root usa-se
mysql -u root -p

--comandos dentro para dentro do mysql
show databases; (lista todos os bancos de dados)
-sempre usar o ; no final de cada comando
create database "meubanco"; (cria um banco de dados com o nome escolhido sem aspas)
use "meubanco"; (para utulizar o banco de dados escolhido sem aspas)
create table "pessoas" (Pessoaid int, Nome varchar(50), Sobrenome varchar(50), Endereco varchar(100), Cidade varchar(50)); (cria uma tabela de nome escolhido sem aspas e suas colunas)
insert into pessoas (Pessoaid, Nome, Sobrenome, Endereco, Cidade) VALUES (1, 'Diego', 'Priegue', 'Trav. Angustura', 'Belem-SP'); (inserção de dados na tabela pessoas)
select * from "pessoas"; (exibe o conteúdo da tabela pessoas sem aspas)
-para sair do prompt mysql usa-se o comando "exit"


